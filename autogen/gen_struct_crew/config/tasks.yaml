generate_bpmn:
  description: >
    На основе текстового описания бизнес-процесса создайте полную BPMN-диаграмму.
    
    ВХОДНЫЕ ДАННЫЕ:
    Вы получите описание бизнес-процесса на русском языке в переменной {process_description}.
    
    ПОШАГОВАЯ ИНСТРУКЦИЯ ПО ВЫПОЛНЕНИЮ:
    
    ШАГ 1: АНАЛИЗ ОПИСАНИЯ
    Внимательно прочитайте описание процесса и определите:
    - Кто участвует в процессе (сотрудники, отделы, системы, клиенты)
    - Какие действия выполняются
    - В какой последовательности происходят действия
    - Есть ли условия/развилки в процессе
    - Есть ли параллельные действия
    - Как участники взаимодействуют между собой
    
    ШАГ 2: ОПРЕДЕЛЕНИЕ УЧАСТНИКОВ (actors)
    Создайте список GBPMNActor для каждого уникального участника процесса:
    - Отделы (например: "Отдел продаж", "Бухгалтерия")
    - Роли (например: "Менеджер", "Клиент")
    - Системы (например: "CRM система", "Платежная система")
    Присвойте каждому актору уникальный id.
    
    ШАГ 3: СОЗДАНИЕ ПРОЦЕССОВ
    Если необходимо, можно определить несколько процессов. В рамках процесса действует несколько акторов.
    Если необходимо передать данные между процессами, нужно использовать сообщения и соответствующие виды связей.
    
    ШАГ 4: МОДЕЛИРОВАНИЕ ЭЛЕМЕНТОВ ПРОЦЕССА
    Для каждого процесса создайте элементы (GBPMNElement):
    
    a) НАЧАЛЬНОЕ СОБЫТИЕ:
       - type: "event"
       - name: краткое название (например: "Процесс начат", "Получена заявка")
    
    b) ЗАДАЧИ (для каждого действия):
       - type: "task"
       - subtype
       - name: глагол + объект (например: "Проверить документы", "Отправить заявку")
    
    c) ШЛЮЗЫ (для условий и параллельности):
       - Для "если/то": type="gateway", subtype="exclusive"
       - Для "И": type="gateway", subtype="parallel"
       - Для "ИЛИ": type="gateway", subtype="inclusive"
       - Создавайте парные шлюзы: один для разделения потока, второй для объединения
       - условия описывайте в потоках
    
    d) КОНЕЧНОЕ СОБЫТИЕ:
       - type: "event"
       - subtype: "end"
       - name: результат процесса (например: "Заказ выполнен", "Процесс завершен")
    
    ШАГ 5: СОЗДАНИЕ ПОСЛЕДОВАТЕЛЬНЫХ ПОТОКОВ (sequence_flows)
    Для каждого процесса определите последовательно соединения элементов, из которых он состоит (GBPMNFlow с type="sequence")
    - Соедините элементы в правильной последовательности
    - source_id и target_id должны ссылаться на id элементов
    - Для потоков из шлюзов указывайте условия в name (например: "Да", "Нет", "Утверждено")
    
    ШАГ 6: СОЗДАНИЕ ПОТОКОВ СООБЩЕНИЙ (message_flows)
    Если разные процессы взаимодействуют, создайте GBPMNFlow с type="message", его нужно добавить в message_flows GBPMNDiagram
    - source_id: id элемента отправителя из одного процесса
    - target_id: id элемента получателя из другого процесса
    - name: что передается (например: "Заявка", "Документы", "Уведомление")
    
    ТРЕБОВАНИЯ К КАЧЕСТВУ:
    - Все id должны быть уникальными в формате "actor_element_N" (например: "sales_task_1")
    - Каждый элемент должен иметь actor_id, ссылающийся на существующего актора
    - Все source_id и target_id в потоках должны ссылаться на существующие элементы
    - Имена должны быть на русском языке и понятными
    - Процесс должен быть логически связным (нет "висячих" элементов)
    - Каждый шлюз разделения должен иметь парный шлюз объединения
    
    ПРИМЕРЫ ПРАВИЛЬНОГО МОДЕЛИРОВАНИЯ:
    
    Пример 1: Простая последовательность
    "Менеджер получает заявку, проверяет её и отправляет в обработку"
    - Элементы: start → task(проверить) → task(отправить) → end
    
    Пример 2: Условие
    "После проверки, если заявка корректна, она отправляется в обработку, иначе возвращается клиенту"
    - Элементы: start → task(проверить) → gateway(exclusive) → [task(отправить) ИЛИ task(вернуть)] → gateway(объединение) → end
    
    Пример 3: Параллельность
    "После утверждения заказа одновременно производится списание средств и отправка товара"
    - Элементы: start → task(утвердить) → gateway(parallel) → [task(списать) И task(отправить)] → gateway(объединение) → end
    
    Пример 4: Межпроцессное взаимодействие
    "Клиент отправляет заявку менеджеру. Менеджер обрабатывает и отправляет ответ клиенту"
    - Процесс 1 (Клиент): start → task(отправить заявку) → wait → task(получить ответ) → end
    - Процесс 2 (Менеджер): start → task(получить заявку) → task(обработать) → task(отправить ответ) → end
    - message_flows: "Клиент.отправить заявку" → "Менеджер.получить заявку", "Менеджер.отправить ответ" → "Клиент.получить ответ"
    
    ВАЖНО: 
    - Ваш ответ ДОЛЖЕН быть валидным объектом GBPMNDiagram
    - НЕ добавляйте объяснений или комментариев
    - Убедитесь, что все ссылки корректны и все обязательные поля заполнены

  expected_output: >
    Структурированный объект GBPMNDiagram, содержащий:
    - name: название диаграммы процесса
    - actors: список всех участников процесса (GBPMNActor)
    - processes: список процессов для каждого актора (GBPMNProcess)
      - Каждый процесс содержит:
        - elements: все элементы процесса (события, задачи, шлюзы)
        - sequence_flows: последовательные потоки внутри процесса
    - message_flows: потоки сообщений между различными участниками
    
    Диаграмма должна быть:
    - Полной (содержать все элементы описанного процесса)
    - Корректной (все связи валидны, нет висячих элементов)
    - Понятной (четкие названия элементов)
    - Соответствующей стандарту BPMN 2.0

    ВАЖНО: 
    - Ваш ответ ДОЛЖЕН быть валидным объектом GBPMNDiagram
    - НЕ добавляйте объяснений или комментариев
    - Убедитесь, что все ссылки корректны и все обязательные поля заполнены
    - Никакого форматирования (markdown) в выводе быть не должно, только объект данных по описанию
